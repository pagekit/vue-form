/*!
 * vue-form v0.3.8
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueForm=e()}(this,function(){"use strict";function t(t){"undefined"!=typeof console&&z&&console.warn("[VueForm warn]: "+t)}function e(t){return"string"==typeof t}function i(t){return null!==t&&"object"==typeof t}function n(t){return void 0===t}function a(t,e,i,n){t.addEventListener(e,i,n)}function o(t,e,i,n){t.removeEventListener(e,i,n)}function l(t,e){return t?t.getAttribute(e):null}function r(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!1),t.dispatchEvent(i)}function s(t){return j.camelize(t)}function u(t,e){t.splice(t.indexOf(e),1)}function d(t,e){var n,a;if("number"==typeof t.length)for(n=0;n<t.length;n++)e.call(t[n],t[n],n);else if(i(t))for(a in t)t.hasOwnProperty(a)&&e.call(t[a],t[a],a);return t}function f(t,e){return"boolean"!=typeof e&&(e=!0),"boolean"==typeof t?!e||t:!e||!(null===t||0===t.length)}function v(t){return/^[-+]?[0-9]+$/.test(t)}function c(t){return/^(?:[-+]?(?:0|[1-9][0-9]*))$/.test(t)}function h(t){return/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/.test(t)}function p(t){return/^([A-Z]+)?$/i.test(t)}function m(t){return/^([0-9A-Z]+)?$/i.test(t)}function g(t){return/^([a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)?$/i.test(t||"a@a.aa")}function b(t){return/^((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)?$/.test(t)}function y(t,e){return t&&t.length&&t.length>=+e}function $(t,e){return t&&t.length&&t.length<=+e}function x(t){return t&&t.length==+arg}function w(t,e){return t>=+e}function F(t,e){return t<=+e}function O(t,e){var i=e.match(new RegExp("^/(.*?)/([gimy]*)$"));return new RegExp(i[1],i[2]).test(t)}function _(t){return function(e){e.preventDefault(),M.validate(e.target,!0)&&t(e)}}function E(t){E.installed||(A(t),t.fields=V,t.component("fields",S(t)),t.validator=M,t.filter("valid",_),t.directive("validator",I),t.directive("validate",P),t.config.optionMergeStrategies.fields=t.config.optionMergeStrategies.props)}var z=!1,j={},k=Array.isArray,A=function(t){j=t.util,z=t.config.debug||!t.config.silent},T=Object.assign||function(t){for(var e=arguments,i=1;i<arguments.length;i++){var n=e[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},N={name:"field",props:["field","class"],data:function(){return T({name:"",type:"text",label:"",attrs:{},options:[],default:void 0},this.field)},created:function(){this.key='["'+this.name.replace(/\./g,'"]["')+'"]'},computed:{attrs:{get:function(){return this.disabled&&this.$parent.evaluate(this.disabled)?T({disabled:"true"},this.$data.attrs):this.$data.attrs},cache:!1},value:{get:function(){var t=this.$parent.getField(this);return n(t)&&!n(this.default)&&(t=this.default)&&this.$parent.setField(this,t),t},set:function(t){n(this.value)&&!t||this.$parent.setField(this,t,this.value)},cache:!1}},methods:{filterOptions:function(e){var n=this,a=[];return e?(d(e,function(t,e){i(t)?a.push({label:e,options:n.filterOptions(t)}):a.push({text:e,value:t})}),a):(t("Invalid options provided for "+this.name),a)}},filters:{options:function(t){return this.filterOptions(t)}}},S=function(n){return{name:"fields",props:{config:{type:[Array,Object],default:function(){return[]}},values:{type:Object}},created:function(){var a=this.$options,o=a.fields,l=a.components;if(!this.fields||!this.values)return void t("Invalid config or model provided");d(T({},n.fields,o),function(t,a){e(t)&&(t={template:t}),i(t)&&(t.name=t.name||"field-"+a,t=n.extend(N).extend(t)),l[a]=t})},computed:{fields:function(){return this.filterFields(this.config)}},methods:{getField:function(t){return this.values instanceof n&&"getField"in this.values?this.values.getField(t):this.$get("values"+t.key)},setField:function(t,e,i){this.values instanceof n&&"setField"in this.values?this.values.setField(t,e,i):this.$set("values"+t.key,e)},filterFields:function(i){var n=this,a=k(i),o=[];return d(i,function(i,l){e(i.name)||a||(i.name=l),e(i.type)||(i.type="text"),e(i.name)?i.show&&!n.evaluate(i.show)||o.push(i):t("Field name missing "+JSON.stringify(i))}),o},evaluate:function(t,e){e=e||this.values;var i=new n({data:e}),a=i.$eval(t);return i.$destroy(),a}},fields:{},components:{},template:'<div>\n\n    <div v-for="field in fields">\n        <label v-if="field.type != \'checkbox\'">{{ field.label }}</label>\n        <component :is="field.type" :field="field"></component>\n    </div>\n\n</div>\n'}},V={text:'<input type="text" v-bind="attrs" v-model="value">',textarea:'<textarea v-bind="attrs" v-model="value"></textarea>',radio:'<template v-for="option in options | options">\n                    <input type="radio" v-bind="attrs" :name="name" :value="option.value" v-model="value"> <label>{{ option.text }}</label>\n                 </template>',checkbox:'<input type="checkbox" v-bind="attrs" v-model="value">',select:'<select v-bind="attrs" v-model="value">\n                     <template v-for="option in options | options">\n                         <optgroup :label="option.label" v-if="option.label">\n                             <option v-for="opt in option.options" :value="opt.value">{{ opt.text }}</option>\n                         </optgroup>\n                         <option :value="option.value" v-else>{{ option.text }}</option>\n                     </template>\n                 </select>',range:'<input type="range" v-bind="attrs" v-model="value">',number:'<input type="number" v-bind="attrs" v-model="value">'},L=Object.freeze({required:f,numeric:v,integer:c,float:h,alpha:p,alphanum:m,email:g,url:b,minlength:y,maxlength:$,length:x,min:w,max:F,pattern:O}),M={dirs:[],types:L,add:function(t){this.dirs.push(t)},remove:function(t){u(this.dirs,t)},instance:function(t){do{if(t._validator)return t._validator;t=t.parentElement}while(t)},validate:function(t,e){var i=this,n=this.instance(t),a={valid:!0};if(n)return this.dirs.forEach(function(t){var o=t.validate(),l=t.el,r=t.name;i.instance(l)===n&&(!l._touched&&e&&(l._touched=!0),l._touched||o||(o=!0,a.valid=!1),a[r]||(a[r]={valid:!0,invalid:!1,dirty:l._dirty,touched:l._touched}),a[r][t.type]=!o,e&&a.valid&&!o&&l.focus(),a[r].valid&&!o&&(a[r].valid=!1,a[r].invalid=!0,a.valid=!1))}),a.invalid=!a.valid,n.results(a),e&&a.invalid&&r(n.el,"invalid"),a.valid}},I={bind:function(){var t=this,e=this.arg||this.expression;this.name=s(e),this.el._validator=this,this.vm.$set(this.name),this.vm.$on("hook:compiled",function(){M.validate(t.el)})},unbind:function(){this.vm.$delete(this.name)},results:function(t){this.vm.$set(this.name,T({validate:this.validate.bind(this)},t))},validate:function(){return M.validate(this.el,!0)}},P={priority:500,bind:function(){var t=l(this.el,"name");t&&(this.name=s(t),this.type=this.arg,this.value=this.el.value,this.el._dirty=!1,this.el._touched=!1,a(this.el,"blur",this.listener.bind(this)),a(this.el,"input",this.listener.bind(this)),M.add(this))},unbind:function(){o(this.el,"blur",this.listener),o(this.el,"input",this.listener),M.remove(this)},update:function(t){this.args=t},listener:function(t){(!t.relatedTarget||"A"!==t.relatedTarget.tagName&&"BUTTON"!==t.relatedTarget.tagName)&&("blur"==t.type&&(this.el._touched=!0),this.el.value!=this.value&&(this.el._dirty=!0),M.validate(this.el))},validate:function(){var t=this.validator();if(t)return t.call(this.vm,this.el.value,this.args)},validator:function(){var t,e=this,i=this.vm;do{if(t=i.$options.validators||{},t[e.type])return t[e.type];i=i.$parent}while(i);return M.types[this.type]}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(E),E});